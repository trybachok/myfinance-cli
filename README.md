# MyFinance CLI

Консольное приложение для управления личными финансами на Java.  
Поддерживает нескольких пользователей, регистрацию и авторизацию, ведение доходов и расходов, бюджеты по категориям, отчёты и переводы между пользователями.

---

## Возможности

- Регистрация и авторизация пользователей по логину и паролю
    - пароли хранятся безопасно в виде SHA-256 хэша
    - поддерживается сброс пароля

- Управление кошельком пользователя
    - добавление доходов и расходов по категориям
    - хранение всех операций в файлах JSON
    - бюджеты по категориям расходов (лимиты)
    - оповещения:
        - при 80% и 100% использования лимита
        - при перерасходе
        - при нулевом или отрицательном балансе

- Отчёты и статистика
    - общий доход и расход
    - суммы по категориям
    - выборка по периоду и нескольким категориям
    - форматированное отображение в таблицах
    - экспорт/импорт отчётов в форматах CSV и JSON

- Переводы между пользователями
    - расход у отправителя, доход у получателя
    - идентификация по логину

- Удобный CLI UX
    - иерархическое меню
    - команда `help` в главном и пользовательском меню
    - понятные сообщения об ошибках ввода

---

## Архитектура

Проект построен по принципам ООП, SOLID, KISS, DRY, YAGNI и чистой архитектуры.

Основные пакеты:

```text
com.myfinance
├─ model        // доменные сущности: User, Wallet, Transaction, Income, Expense, Category, Budget
├─ repository   // интерфейсы и файловые реализации хранилищ
├─ service      // бизнес-логика: AuthService, WalletService, TransferService, ReportGenerator
├─ cli          // консольный интерфейс: ConsoleApp, Main, HelpPrinter, TablePrinter, InputValidator
└─ util         // утилиты: JsonUtil, JsonFileUtil, HashUtil, CsvUtil
```

## Примеры вложенных классов

- Transaction.DateComparator / Transaction.AmountComparator — static nested classes для сортировок.
- Wallet.Alert — inner-class, связанный с конкретным кошельком, отвечает за оповещения.

Пример анонимного класса:
- В ReportGenerator.sortByAmountDesc используется анонимная реализация Comparator<Transaction>.

---

## Хранение данных

Все данные хранятся в директории src/db:
- src/db/users.json — список пользователей.
- src/db/wallets/<login>.json — кошелёк конкретного пользователя.

Отчёты (CSV/JSON) можно сохранять в src/db или любую другую директорию.
Файлы и директории создаются автоматически при первом запуске приложения.

---

## Требования

- Java **17+**
- Maven **3.8+**
- Git (для клонирования и CI)
- Аккаунт GitHub

---

## Установка и запуск

### 1. Клонировать репозиторий

```bash
git clone https://github.com/your-account/myfinance-cli.git
cd cd myfinance-cli
````

### 2. Сборка и тесты

```bash
mvn clean verify
```

Эта команда:

* компилирует проект,
* запускает все тесты,
* проверяет стиль кода (Spotless),
* формирует отчёт покрытия JaCoCo (`target/site/jacoco/index.html`).

### 3. Запуск приложения

#### Через IntelliJ IDEA

Открой проект → класс `com.myfinance.cli.Main` → **Run**.

#### Через терминал

```bash
mvn exec:java -Dexec.mainClass="com.myfinance.cli.Main"
```

или

```bash
java -cp target/myfinance-cli-1.0-SNAPSHOT.jar com.myfinance.cli.Main
```

---

### Ввод пароля

> При запуске приложения из **реального терминала** (macOS Terminal, PowerShell, Bash и т.д.) пароль вводится **в скрытом режиме** — символы не отображаются на экране.  
> Это реализовано через `System.console().readPassword()` в классе [`PasswordReader`](src/main/java/com/myfinance/cli/PasswordReader.java).

**Важно:**  
Если приложение запускается **из IntelliJ IDEA** или другой IDE, то `System.console()` недоступен, и пароль временно считывается обычным способом (символы видны).  
Это ограничение среды разработки, а не самой программы.

Для безопасного ввода рекомендуется запускать проект из терминала:

```bash
mvn exec:java -Dexec.mainClass="com.myfinance.cli.Main"
```

## Примеры использования
1. Регистрация и вход
- Запустите приложение.
- В главном меню выберите 2 — зарегистрироваться.
- Введите логин и пароль.
- Затем в главном меню выберите 1 — войти, и укажите те же данные.
2. Добавление операций
- После входа:
- 1 — добавить доход (Зарплата, сумма 20000, описание оклад).
- 2 — добавить расход (Еда, сумма 500, описание обед).
3. Настройка бюджета
- В меню кошелька выберите 3 — управление бюджетами.
- 1 — установить лимит по категории (например, Еда, лимит 4000).
- 3 — показать таблицу бюджетов и остатка по каждой категории.
4. Отчёты
- В меню кошелька выберите 4:
- 1 — общий итог (доходы, расходы, по категориям и бюджеты).
- 2 — выборка по периоду (например, 2025-05-01 — 2025-05-31) и категориям (например, Еда,Развлечения).
5. Переводы
- Войдите под пользователем A, добавьте ему доход.
- В меню кошелька выберите 5, укажите логин пользователя B и сумму перевода.

